---
title: "Anostraca" # 
title-block-banner: "#ad180d" 
title-block-banner-color: white 

author:
  - name:
      given: Bestie
      family: Milne 
    orcid: 0000-0002-9431-8540
    affiliations:
      - ref: bec 
      - ref: saeon   
          
  - name:
      given: Daksha 
      family: Bills 
    #orcid: 0000-0000-0000-0000 
    affiliations:
      - ref: am

  - name:
      given: Keenan
      family: Meissenheimer 
    orcid: 0000-0002-4148-2718 
    affiliations:
      - ref: sanbi  
      - ref: birdlife 

  - name: 
      given: Dewidine 
      family: van Der Colff 
    orcid: 0000-0002-0906-7098 
    affiliations:
      - ref: sanbi 
 
  - name:
      given: Shae-Lynn E.
      family: Hendricks
    orcid: 0009-0003-1733-1156
    affiliations:
      - ref: sanbi   
      
  - name:
      given: Maphale S. 
      family: Monyeki 
    orcid: 0000-0002-5083-7461 
    affiliations:
      - ref: sanbi
      
  - name:
      given: Musa 
      family: Mlambo 
    #orcid: 0000-0000-0000-0000 
    affiliations:
      - ref: am      

affiliations:
  - id: bec  
    number: 1 
    name: Boscia Ecological Consulting 
    
  - id: saeon  
    number: 2 
    name: South African Environmental Observation Network    

  - id: am 
    number: 3 
    name: Albany Museum
    
  - id: sanbi 
    number: 4 
    name: South African National Biodiversity Institute 
    
  - id: birdlife  
    number: 5 
    name: BirdLife South Africa
    
date: last-modified
bibliography: species.bib

citation:
  type: webpage
  container-title: National Biodiversity Assessment 2025
  publisher: South African National Biodiversity Institute
  url: http://nba.sanbi.org.za/

appendix-cite-as: false
google-scholar: true

format: 
  html:
    embed-resources: true
---

--------------------------------------------------------------

<center>

![*Streptocephalus namibiensis*(LC) is endemic to southern Africa, occurring in Botswana, South Africa and Namibia, where it is widespread, but mainly occupies temporary brackish pans. As with all anostracans, their taxonomic features are complex and are only visible under high magnification. Therefore accurate species identification requires specialised expertise. © Betsie Milne.](./imgs/sp_anostraca_img_1.png){fig-align="center"}

</center>

::::::: columns
::: {.column width="33.3%"}
<center>

| [25%]{.inline-style-threatened}
| of 36 assessed species are
| [Threatened]{.inline-style-indicator}

</center>
:::

::: {.column width="33.3%"}
<center>

| [64%]{.inline-style-not-protected}
| of 36 species are assessed as 
| [Least Concern]{.inline-style-indicator}

</center>
:::

::: {.column width="33.3%"}
<center>

| [44%]{.inline-style-not-protected}
| species are 
| [Endemic]{.inline-style-indicator}

</center>
:::

::: {.column width="25%"}
```{r}
#| label: fig-0
#| fig-cap: "*add image*"
#knitr::include_graphics("")
```
:::
:::::::

------------------------------------------------------------------------

## Key findings

-  There are 38 described Anostraca species in South Africa, representing ~11% of the world's species (~353)[@rogers2013a]. 

-  A comprehensive assessment of 36 Anostraca species was conducted for the first time using the IUCN Red List Categories and Criteria to classify their risk of extinction (two species are still in review, which will take the total assessed species to 38). 

-	 Of the assessed taxa, nine species (25%) were assessed as threatened with extinction, and of these, two species are considered Critically Endangered (Possibly Extinct) (Meyer-Milne et al. in prep).

-	 Endemism is high, with 44% (16) species only found in South Africa. Of these, 56% (9 species) are threatened with extinction, placing sole responsibility on South Africa to protect and conserve these species (Meyer-Milne et al. in prep).

-
This assessment of Anostraca contributed to 58% of the global Anostraca IUCN assessments, making a sizeable contribution to the understanding of the current state of these temporary freshwater habitat indicator species. 

-  The IUCN Red List Index (RLI) assessment revealed that Anostraca have the third lowest RLI score (0.84), making it one of the most threatened taxonomic groups in South Africa. This illustrates the need for further surveys of temporary freshwater systems in the country, to understand their drivers of threat better as well as guide efforts to prevent further losses.

-  Major threats to Anostraca are habitat loss and degradation due to urban and agricultural expansion, and mining. 


::::: columns
::: {.column width="50%"}
-   

-   

-   
:::

::: {.column width="50%"}
```{r}
#| label: fig-1
#| fig-cap: "Species richness map..."
#knitr::include_graphics("")
```
:::
:::::

### Threat status, trends and pressures

1.  ***Threat status***

add text

:::: panel-tabset
## Figure

<!-- it is important to use second-level headings in panel tabsets, i.e. two hashes -->

```{r}
#| label: fig-2
#| fig-cap: "Threat status of South African ... " 
#| out-width: 100%
#| out-height: "auto"

library(dplyr)
library(tidyr)
library(nbaR)
library(readxl)
library(patchwork)
library(ggplot2)
library(grid)

# ---- Dataset ----

df <- read_excel("./data/overall_status_summary_2025.xlsx",
                 sheet = "Summary")


# ---- Recode Status ----
df <- df %>%
  mutate(Status = recode(Status,
    "CR" = "Critically Endangered",
    "CR (PE)" = "Critically Endangered (Possibly Extinct)",
    "EN" = "Endangered",
    "VU" = "Vulnerable",
    "NT" = "Near Threatened",
    "DD" = "Data Deficient",
    "LC" = "Least Concern",
    "EW" = "Extinct in the Wild",
    "EX" = "Extinct",
    "Rare" = "Rare"
  ))


# ---- Functions ----

# Collapse rare categories into "Rare"
collapse_rare <- function(df) {
  df %>%
    filter(!Status %in% c("NA", "NE")) %>%
    mutate(Status = ifelse(Status %in% c("Rare", "Critically Rare", "Extremely Rare"),
                           "Rare", Status))
}

# Convert to wide with consistent threat columns
make_wide <- function(df, type, all_levels) {
  df_wide <- df %>%
    group_by(`Taxonomic grouping`, Status) %>%
    summarise(Count = n(), .groups = "drop") %>%
    filter(Status %in% all_levels) %>%
    tidyr::pivot_wider(
      names_from = Status,
      values_from = Count,
      values_fill = 0
    )
  
  # add missing threat columns with zeros
  missing <- setdiff(all_levels, names(df_wide))
  for (m in missing) df_wide[[m]] <- 0
  
  df_wide %>%
    mutate(Type = type) %>%
    select(Type, everything(), all_of(all_levels))
}

# Add total number to donut hole
add_total <- function(plot, total, SCALE_TEXT = 1) {
  plot + annotate("text",
                  x = 2, y = 0,
                  label = total,
                  size = 3.5 * SCALE_TEXT,
                  fontface = "bold")
}

# ---- Setup ----
status_levels <- c(
  "Extinct",
  "Extinct in the Wild",
  "Regionally Extinct",
  "Critically Endangered (Possibly Extinct)",
  "Critically Endangered",
  "Endangered",
  "Vulnerable",
  "Near Threatened",
  "Data Deficient",
  "Rare",
  "Least Concern"
)

all_levels <- status_levels

# ---- Anostraca ----
df_anostraca <- df %>%
  filter(`Taxonomic grouping` == "Anostraca") %>%
  collapse_rare() %>%
  mutate(Status = factor(Status, levels = status_levels))

df_anostraca_en <- df %>%
  filter(`Taxonomic grouping` == "Anostraca", Endemism == "Endemic") %>%
  collapse_rare() %>%
  mutate(Status = factor(Status, levels = status_levels))

df_anostraca_wide    <- make_wide(df_anostraca, "Overall", all_levels)
df_anostraca_en_wide <- make_wide(df_anostraca_en, "Endemic", all_levels)

df_combined <- bind_rows(df_anostraca_wide, df_anostraca_en_wide)

# Identify which threat categories actually have data
available_levels <- df_combined %>%
  select(all_of(all_levels)) %>%
  summarise(across(everything(), sum)) %>%
  pivot_longer(everything(), names_to = "Status", values_to = "Total") %>%
  filter(Total > 0) %>%
  pull(Status)

dat1 <- filter(df_combined, Type == "Overall")
dat2 <- filter(df_combined, Type == "Endemic")
# Filter columns and update status levels
dat1 <- dat1 %>% select(Type, all_of(available_levels))
dat2 <- dat2 %>% select(Type, all_of(available_levels))


overall <- dat1 %>% select(all_of(available_levels)) %>% rowSums()
endemic <- dat2 %>% select(all_of(available_levels)) %>% rowSums()


# ---- Plots ----
plot1 <- nba_plot(dat1, biome, 2:(ncol(dat1)),
                  CHRT = "donut", NUM = FALSE, LAB = "A.") %>%
  add_total(overall)

plot2 <- (nba_plot(dat2, biome, 2:(ncol(dat2)),
           CHRT = "donut", NUM = FALSE, LAB = "B.") +
    xlim(c(2, 4.5))) %>% add_total(endemic)


# ---- specify legend order ----

my_fill_scale <- scale_fill_manual(
   values = NBA_colours[available_levels],
  breaks = available_levels,
  guide = guide_legend(ncol = 4),
  drop = FALSE
)

plot1 <- plot1 + my_fill_scale
plot2 <- plot2 + my_fill_scale


# ---- Combine with one legend ----
combined_donut_plot <- (plot1 | plot2) +
  plot_layout(guides = "collect") &
  theme(legend.position = "bottom",
        legend.justification = "center")

combined_donut_plot

```

## Data

<!--# If the table is long use the div to give it a vertical scroll bar. Otherwise the div can be excluded. -->

::: {#table .table style="height:500px;overflow-y: auto"}
```{r}
#| label: tbl-tab-0
#| tbl-cap: "Plant threat status." 
#| classes: plain

library(gt)

# First, select only the columns we want and rename Type → Taxon
dat1_sel <- dat1 %>% select(1, 2:ncol(dat1)) %>% rename(Taxon = Type)
dat2_sel <- dat2 %>% select(1, 2:ncol(dat2)) %>% rename(Taxon = Type)

# Now assign custom row names (or first column values)
dat1_sel$Taxon <- "Overall spiders"
dat2_sel$Taxon <- "Endemic spiders"

# Combine into one table
dat_combined_final <- bind_rows(dat1_sel, dat2_sel)

dat_combined_final <- dat_combined_final %>%
                      rowwise() %>%
                      mutate(Total = sum(c_across(2:ncol(dat_combined_final)), na.rm = TRUE)) %>%
                      ungroup() %>%
  select(Taxon, all_of(available_levels), Total)
  
gt(dat_combined_final) %>% 
  nba_tbl_theme() %>%
  tab_options(table.width = pct(100),
              data_row.padding = px(12)) %>%

  tab_style(style = cell_fill(color = "gray90"),
            locations = cells_column_labels(columns = everything())) %>%

  cols_width(Taxon ~ pct(15),
             everything() ~ pct(10))
```
:::
::::

2.  ***Trends (RLI)***

add text

```{r}
#| label: fig-3
#| fig-cap: "The Red List Index (RLI) for ..."

library(tidyverse)
library(nbaR)
# --- Dataset ---

df_rlis <- readxl::read_excel("./data/nba_example_RLI_data_trim.xlsx")

df_anostraca <- df_rlis%>%
  filter(Taxon %in% c("Anostraca", "Aggregate"))

nba_index_plot(
  TYPE = "RLIs",
  DF = df_anostraca,
  YEAR = Year,
  RLI = RLI,
  ASSESSMENT_YEAR = Assessment_Year,
  GROUP = Taxon,
  PALETTE = "taxon",
 # AGGREGATE = TRUE,
  SAVE = NULL
)
```

```{r}
#| label: fig-4
#| fig-cap: "The distribution of ... "

#knitr::include_graphics("imgs/Plant_heatmap.png")
```

::: {#box-1 .callout-note .species title="Box 1. Species box" collapse="true"}
## Box 1. Title

add text

remove the syntax "<!-- -->" for inserting the images replace existing with appropriate images for current page <!-- ![](imgs/Fig%201.png){fig-alt="box_1_fig_1" width="45%"}--> <!-- ![](imgs/Figure%202.png){fig-alt="box_1_fig_2" width="45%"}-->
:::

3.  ***Pressures***

add text

```{r}
#| label: fig-5
#| fig-cap: "Key pressures on South Africa’s ... "
#| out.width: 100%


library(stringr)

df <- readxl::read_excel("./data/combined_threat_summary.xlsx", 
                 sheet = "Overall_Maj")


Anostraca<- nba_pressure_bar_plot(
                          df,
                          TAXON = "Anostraca")

Anostraca
```

:::::: {#box-2 .callout-note .species title="Box 2. Species box" collapse="true"}
## Box 2. Title

::::: columns
::: {.column width="100%"}
Add text

remove the syntax "<!-- -->" for inserting the images replace existing with appropriate images for current page <!--![](imgs/Euphorbias%20received.jpg){fig-alt="box_2_fig_2" width="45%"} ![](imgs/fd44b009-60e2.png){fig-alt="box_2_fig_1" width="45%"}

![](imgs/1000067813.png){fig-alt="box_2_fig_1" width="45%"} ![](imgs/20221203_074211.png){fig-alt="box_2_fig_1" width="45%"} -->
:::

::: {.column width="25%"}
:::
:::::
::::::

## Protection level

### Main findings

Add text

```{r}
#| label: fig-6
#| eval: false
#| include: false

library(dplyr)
library(tidyr)
library(nbaR)
library(readxl)
library(patchwork)
library(ggplot2)
library(grid)

dat1 <- read_excel("./data/nba_example_pro_data.xlsx", 
    sheet = "2025")
dat1 <- dat1 %>%
  filter(`Taxon groups`== "Anostraca")
dat2 <- read_excel("./data/nba_example_pro_data.xlsx", 
    sheet = "2025_en")
dat2 <- dat2 %>%
  filter(`Taxon groups`== "Anostraca")

# Add total number to donut hole
# Updated add_total() function
add_total <- function(plot, total, SCALE_TEXT = 1) {
  plot + annotate("text",
                  x = 2, y = 0,
                  label = total,
                  size = 3.5 * SCALE_TEXT,
                  fontface = "bold")
}



# Calculating totals  
total_a <- dat1 %>%
  select(2:5) %>%
  mutate(across(everything(), as.numeric)) %>%
  rowSums(na.rm = TRUE) %>%
  sum(na.rm = TRUE)
total_b <- dat2 %>%
  select(2:5) %>%
  mutate(across(everything(), as.numeric)) %>%
  rowSums(na.rm = TRUE) %>%
  sum(na.rm = TRUE)  


plot1 <- nba_plot(dat1,
                  biome,
                  2:5,
                  CHRT = "donut",
                  NUM = FALSE,
                  LAB = "A. Overall",
                  SAVE = NULL)%>%
  add_total(total_a)

plot2 <- (
  nba_plot(dat2,
           biome,
           2:5,
           CHRT = "donut",
           NUM = FALSE,
           LAB = "B. Endemic",
           SAVE = NULL) +
    xlim(c(2, 4.5))
) %>%
  add_total(total_b)

# Combine and put shared legend at bottom center
combined_plot <- plot1 + plot2 +
  patchwork::plot_layout(guides = "collect") & 
  ggplot2::theme(legend.position = "bottom",
        legend.justification = "center")

combined_plot



```

```{r}
#| label: fig-7
#| fig-cap: "image caption"

#knitr::include_graphics("imgs/Daubenya_namaquensis.png")
```

Further analysis and main findings can be found on the [Assessment Summary Statistics page](assessment-summary-statistics.html)

## Monitoring

add text

## Species recovery

::: {#box-3 .callout-note .species title="Box 3. Species box" collapse="true"}
## Box 3. Title

Add text

remove the syntax "<!-- -->" for inserting the images replace existing with appropriate images for current page <!--![](imgs/image%20(3).png){fig-alt="box_3_fig_1" width="45%"} ![](imgs/image.png){fig-alt="box_3_fig_2" width="45%"}-->

![](imgs/Recovery_work.png)
:::

## Knowledge gaps

add text

### Recommended citation

```{r}
#| output: asis
#| label: lst-citation-code

library(nbaR) 
library(knitr)
library(rmarkdown)

# Code for fetching the yaml metadata
# Note that this only runs when the .qmd file is rendered, therefore the outputs of this code block will return no results if you try to run it within R - that does not mean it is not working

meta <- knitr::opts_knit$get("rmarkdown.pandoc.to")  # forces knitr to load metadata
meta <- rmarkdown::metadata  # full YAML is now in `meta`

nba_citation(meta)

```


## References

::: {#refs}

:::
