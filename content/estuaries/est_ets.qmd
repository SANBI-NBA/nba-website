---
# indentations are critical in YAML headers, be careful when editing this section

title: "Ecosystem threat status" # Compulsory
subtitle: "Estuarine realm" # Optional: delete if you are not using a subtitle

title-block-banner: "#028A85" #Background colour of the title block: Apply component colours where necessary - find hex codes in _brand.yml
title-block-banner-color: white # Header text colour: DO NOT CHANGE

# List authors here in the order you want them displayed in the title block
# See examples in README
author:
  - name:
      given: Lara
      family: van Niekerk
    orcid: 0000-0001-5761-1337
    affiliations:
      - ref: csir1
      - ref: nmu1
  - name:
      given: Andrew L.
      family: Skowno 
    orcid: 0000-0002-2726-7886 
    affiliations:
      - ref: sanbi1
  - name:
      given: Kerry
      family: Sink
    orcid: 0000-0001-5051-573X
    affiliations:
      - ref: sanbi1
      - ref: nmu1
  - name:
      given: Linda R.
      family: Harris 
    orcid: 0000-0003-4719-0481  
    affiliations:
      - ref: nmu1

affiliations:
  - id: csir1
    number: 1
    name: Council for Scientific and Industrial Research
  - id: nmu1
    number: 2
    name: Nelson Mandela University
  - id: sanbi1
    number: 3
    name: South African National Biodiversity Institute

# This date determines the PUBLISHED date in the title block
date: last-modified

# Remember to rename the default .bib file and change the name here
bibliography: est_references.bib

# This section sets up the page citation format. DO NOT EDIT
citation:
  type: webpage
  container-title: National Biodiversity Assessment 2025
  publisher: South African National Biodiversity Institute
  url: http://nba.sanbi.org.za/
# Do not edit or change any of the following entries
appendix-cite-as: false
google-scholar: true
---

```{r}
#| echo: false

library(tidyverse)
library(nbaR)


# load the data 
ets_combined <- read.csv(file=list.files(path = "./data", pattern = "^ets_combined_count_extent.csv$", recursive = TRUE, full.names = TRUE), 
                    stringsAsFactors = FALSE, check.names = FALSE) 
  

## extent
eco_extent <- ets_combined %>% 
  pivot_longer(cols = 2:5) %>% 
  filter(metric == "extent")

thr_extent <- ets_combined %>% 
  filter(metric == "extent")


total_extent <- sum(eco_extent$value)

perc_cr_extent <- round((sum(thr_extent$`Critically Endangered`)/total_extent)*100)
perc_en_extent <- round((sum(thr_extent$`Endangered`)/total_extent)*100)
perc_vu_extent <- round((sum(thr_extent$`Vulnerable`)/total_extent)*100)
perc_lc_extent <- round((sum(thr_extent$`Least Concern`)/total_extent)*100)
perc_thr_extent <- round(perc_cr_extent+perc_en_extent+perc_vu_extent)

##count
eco_count <- ets_combined %>% 
  pivot_longer(cols = 2:5) %>% 
  filter(metric == "count")

thr_count <- ets_combined %>% 
  filter(metric == "count")


total_count <- sum(eco_count$value)

perc_cr_count<- round((sum(thr_count$`Critically Endangered`)/total_count)*100)
perc_en_count<- round((sum(thr_count$`Endangered`)/total_count)*100)
perc_vu_count<- round((sum(thr_count$`Vulnerable`)/total_count)*100)
perc_lc_count <- round((sum(thr_count$`Least Concern`)/total_count)*100)
perc_thr_count <- round(perc_cr_count+perc_en_count+perc_vu_count)

```

*The Estuarine Realm is one of the most threatened in South Africa, in terms of both number of ecosystem types and by area. Of South Africa’s `r total_count` estuarine ecosystem types, `r perc_thr_count`% are threatened with `r perc_cr_count`% Critically Endangered, `r perc_en_count`% Endangered and `r perc_vu_count`% Vulnerable. Of total estuarine area, `r perc_thr_extent`% is threatened with `r perc_cr_extent`% Critically Endangered, `r perc_en_extent`% Endangered and `r perc_vu_extent`% Vulnerable. Unsustainable land and sea use can undermine the benefits from healthy ecosystems and the natural capital that can support a thriving economy ([key message A2](../key-messages/kma2.qmd)).*

![Knysna is one of two estuarine bays inside South Africa and is an example of a Vulnerable system. (© Matt Dubber)](imgs/est_knysna_matt_dubber.jpeg)

::::: columns
::: {.column width="50%"}
<center>

| [91%]{.inline-style-threatened}
| of 22 ecosystem types
| [Threatened]{.inline-style-indicator}

| [41%]{.inline-style-endangered}
| of 22 ecosystem types
| [Endangered]{.inline-style-indicator}

</center>
:::

::: {.column width="50%"}
<center>

| [5%]{.inline-style-critically-endangered}
| of 22 ecosystem types
| [Critically Endangered]{.inline-style-indicator}

| [45%]{.inline-style-vulnerable}
| of 22 ecosystem types
| [Vulnerable]{.inline-style-indicator}

</center>
:::
:::::

<!-- creates spaces -->

\

## Ecosystem threat status assessment

The estuarine realm is one of the most threatened in South Africa, in terms of both the number of ecosystem types and by area [@vanniekerk2018].

About `r perc_thr_count`% of the 22 estuary types are threatened, with `r perc_cr_count`% Critically Endangered, `r perc_en_count`% Endangered and `r perc_vu_count`% Vulnerable. Of the total estuarine area, `r perc_thr_extent`% is threatened, with `r perc_cr_extent`% Critically Endangered, `r perc_en_extent`% Endangered and `r perc_vu_extent`% Vulnerable.

Multiple interventions are required to avoid further decline in health. These include protection of freshwater inflow to estuaries and the sea, restoration of water quality, reduction in fishing effort and avoidance of mining, infrastructure development, and crops in the estuarine functional zone.

```{r}
#| label: fig-ets_map
#| fig-cap: Map showing the distribution of threatened estuarine ecosystems according to the IUCN Red List of Ecosystems (size of the dot represents area of the individual estuary). The inset graph shows the number and proportion of ecosystem types that fall within each threat status category.
#| echo: false
#| message: false
#| warning: false
#| out-width: 100%


knitr::include_graphics("imgs/ets_with_donut.png")

```

\
\

:::: panel-tabset
## Figure

```{r}
#| label: fig-ets_bargraphs
#| echo: false
#| fig-cap: Ecosystem threat status of South Africa’s estuaries presented as percentage of ecosystem types (A) and percentage ecosystem extent (B).
#| out-width: 100%
#| classes: plain

library(gt)
library(nbaR)
library(tidyverse)

# load the data 
ets_combined <- read.csv(file=list.files(path = "./data", pattern = "^ets_combined_count_extent.csv$", recursive = TRUE, full.names = TRUE), 
                    stringsAsFactors = FALSE, check.names = FALSE) %>% 
  mutate(
  zone = factor(zone, levels = c("Tropical",
                                  "Subtropical",
                                 "Warm Temperate",
                                 "Cool Temperate"),
                    ordered = TRUE)) %>% 
   arrange(zone) 


#Combine RLE plot
nba_plot_comb(ets_combined,
              zone,
              METRIC_COL = metric,
              METRICS = c("count", "extent"),
              2:5,
              CHRT = "bar",
              NUM = FALSE,
              LAB = "Percentage of ecosystem",
              SAVE = NULL,
              SCALE_TEXT = 1) +
  theme(plot.margin=grid::unit(c(0,0,0,0), "pt")) #remove white space around the plot

```

## Data

::: {#table .table style="height:500px;overflow-y: auto"}
```{r}
#| label: tbl-ets_bargraphs
#| echo: false
#| tbl-cap:  Ecosystem threat status of South Africa’s estuaries tabulated by number of estuaries in a type, estuary types, extent and percentage area in a biogeographical region.
#| out-width: 100%
#| classes: plain

##must round values



tbl <- ets_combined %>% 
  mutate(metric = str_replace_all(metric, "extent", "Extent  (ha)"),
         metric = str_replace_all(metric, "estuary_count", "No. estuaries"),
         metric = str_replace_all(metric, "count", "No. estuary types"),
         metric = str_replace_all(metric, "perc", "Percentage (%)")) %>% 
  mutate(
  zone = factor(zone, levels = c("Cool Temperate",
                               "Warm Temperate",
                               "Subtropical",
                               "Tropical"),
                    ordered = TRUE)) %>% 
   arrange(zone) %>% 
  select(zone, metric, `Critically Endangered`, `Endangered`, `Vulnerable`, `Least Concern`) %>%
  mutate(across(where(is.numeric), round)) %>% 
  gt::gt(
    rowname_col = "metric",
    groupname_col = "zone",
    row_group_as_column = TRUE) %>% 
  fmt_number(
    columns = where(is.numeric),
    decimals = 0,
    sep_mark = "\u202F") %>% 
  fmt_markdown(columns = metric) %>%  # tells gt to render HTML/Markdown in that column
  nbaR::nba_tbl_theme(HEADER = "Estuarine") %>% 
  tab_style(
    style = cell_text(color = "white"),
    locations = cells_column_labels()
  )

tbl %>% 
  gt::tab_options(
    table.width = pct(100),
    data_row.padding = px(5),
    column_labels.font.size = px(15),
    row_group.font.size = px(15),
    table.font.size = px(15)
  )
```
:::
::::

\

### Critically Endangered

Following the application of 2024 IUCN guidelines for red listing ecosystems and drawing from previous estuarine NBA assessments, the Subtropical Estuarine Bay ecosystem type, represented by Durban Bay, is the only system that triggered Critically Endangered.

### Endangered

Nine estuarine ecosystem types were classified as Endangered, with 6 types in the Cool Temperate, 1 in the Warm Temperate and 2 in the Subtropical biogeographical region.

-   Cool Temperate Estuarine Lagoon
-   Cool Temperate Estuarine Lake
-   Cool Temperate Large Fluvially Dominated
-   Cool Temperate Predominantly Open
-   Cool Temperate Large Temporarily Closed
-   Cool Temperate Arid Predominantly Closed
-   Warm Temperate Estuarine Lake
-   Subtropical Large Fluvially Dominated
-   Subtropical Estuarine lake

### Vulnerable

Overall 10 estuarine ecosystem types were classified as Vulnerable, with 2 types in the Cool temperate, 4 in the Warm Temperate, 3 in the Subtropical, and 1 in the Tropical biogeographical region.

-   Cool Temperate Small Temporarily Closed
-   Cool Temperate Small Fluvially Dominated
-   Warm Temperate Estuarine Bay
-   Warm Temperate Large Fluvially Dominated
-   Warm Temperate Predominantly Open
-   Warm Temperate Large Temporarily Closed
-   Subtropical Predominantly Open
-   Subtropical Large Temporarily Closed
-   Subtropical Small Temporarily Closed
-   Tropical Estuarine Lake

\

::: {#box-eco_tbl_ets .callout .estuarine collapse="False"}
```{r}
#| label: tbl-ets
#| tbl-cap: Ecosystem threat status of South Africa’s estuaries, ordered from west to east coast.
#| classes: plain


# library(here)
#library(gt)
library(reactable)
library(dplyr)


# load data
ets <- read.csv(file=list.files(path = "./data/", pattern = "^est_ecotypes.csv$", recursive = TRUE, full.names = TRUE), 
                    stringsAsFactors = FALSE, check.names = FALSE) %>% 
  select(NAME, type, threat_status) %>% 
  rename(`Estuary name` = NAME, 
         `Estuary type` = type, 
         `Threat status` = threat_status)

write.csv(ets, "data/threat_status_per_estuary.csv")

nba_tbl_colr(DF = ets,
             COL = `Threat status`,
             HEADER = "Estuarine") %>%
  tab_options(container.height = px(550),
              container.overflow.y = TRUE)%>% 
  tab_style(
    style = cell_text(color = "white"),
    locations = cells_column_labels()
  )



```

Download the data [here](data/threat_status_per_estuary.csv).
:::

## Approach

The 2025 assessment of South Africa’s 22 estuarine ecosystem types was conducted using the 2024 IUCN guidelines for red listing ecosystems [@keith2024] and drawing from previous estuarine NBA assessments [@vanniekerk2018].

The IUCN RLE (Ver 2) framework was applied and following criterion were assessed:

-   **Criterion A2b** (current rate of decline in ecosystem extent); based on land cover change rates between 1990 and 2022 - projected forward to 2040.

-   **Criterion A3** (historical reduction in ecosystem extent), based on land cover 2022

-   **Criterion B3** was applied to the estuary types that occur at 5 or fewer locations - and for which there is ongoing decline defined as: a) between t1 and t2, fishing pressure shifts from M to H OR H to VH, OR b) PES class A, B and C extent declined by \>1%, OR extent of H and VH Fishing pressure at year of assessment is greater than 30% of type extent. This captures increasing or sustained gill-netting pressures, and steady decline in ecosystem condition as triggers. The rating applies to the whole type and is scaled by estuarine extent.

-   **Criterion D1** was applied using fishing pressure scores for each estuary. The scores were converted to an index 0-1 and aligned to severity rating (1 highest severity - 100%; 0 lowest severity - 0%). The rating applies to the whole type and is scaled by estuarine extent.

-   **Criterion D3** was applied to the Estuarine Ecological State Class (PES) data such that severity of biotic disruption of \>= 90% was assumed for PES classes E-F; Severity \>=70% was assigned to PES classes D-F; Severity \>=50% was assigned to PES classes C-F. The rating applies to the whole type and is scaled by estuarine extent.

Each of the 22 estuary ecosystem types were assigned to one of the four risk categories: Critically Endangered, Endangered, Vulnerable and Least Concern. The highest risk category for these two criteria is selected as the threat / risk status for each river type.

A more detailed explanation of the assessment method can be found at [RLE explanation page](../integrated-findings/chl_rle_explained.qmd).

## Technical documentation

<!--# This section is compulsory for all scientific content, but what you include here is flexible based on what you have available for your indicators -->

<!--# the below examples/recommendations can be modified, e.g. you could do a technical report PDF, as long as it is made available on a public repository (figshare?) and can be linked to in this document -->

<!--# avoid linking to Google Drive or other personal drives that may not be permanent. -->

<!--# Always use DOI to link to published papers - never use the journal's website -->

### Code repositories

-   [Threat status assessment](https://github.com/askowno/RLE_est)

### Key publications

Rowland, J.A. et al. 2020. Ecosystem indices to support global biodiversity conservation. Conservation Letters 13, 11. https://doi.org/10.1111/conl.12680

IUCN. 2024. Guidelines for the application of IUCN Red List of Ecosystems. Gland, Switzerland. https://doi.org/10.2305/CJDF9122

## Recommended citation

```{r}
#| output: asis
#| label: lst-citation-code

library(nbaR) 
library(knitr)
library(rmarkdown)

# Code for fetching the yaml metadata
# Note that this only runs when the .qmd file is rendered, therefore the outputs of this code block will return no results if you try to run it within R - that does not mean it is not working

meta <- knitr::opts_knit$get("rmarkdown.pandoc.to")  # forces knitr to load metadata
meta <- rmarkdown::metadata  # full YAML is now in `meta`

nba_citation(meta)

```

## Refernces

::: {#refs}
:::
