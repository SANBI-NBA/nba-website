---
# indentations are critical in YAML headers, be careful when editing this section

title: "River ecosystem protection level" # Compulsory
subtitle: "Freshwater (inland aquatic) realm" # Optional: delete if you are not using a subtitle

title-block-banner: "#4097C2" #Background colour of the title block: Apply component colours where necessary - find hex codes in _brand.yml
title-block-banner-color: white # Header text colour: DO NOT CHANGE

# List authors here in the order you want them displayed in the title block
# See examples in README
author:
  # Copy this block and add details for each author of your page. Make sure you Make sure you maintain indentations exactly as they are here
  - name:
      given: Nancy 
      family: Job 
    orcid: 0000-0002-4929-7592 
    affiliations:
      - ref: sanbi
  - name:
      given: Andrew 
      family: Skowno
    orcid: 0000-0002-2726-7886
    affiliations:
      - ref: sanbi 
      - ref: uct
  - name:
      given: Jock 
      family: Currie 
    orcid: 0000-0002-7226-2988 
    affiliations:
      - ref: sanbi 
      # If an author has more than one affiliation, add more - ref: lines here
      
affiliations:
# List affiliations here and number them in the order that they are associated with the list of authors above. If multiple authors have the same affiliation, only list the affiliation once here.
# Write out institutional names in full
# See README for common examples - they can be copied and pasted here
# Make sure you maintain indentations exactly as they are here
  - id: sanbi 
    number: 1 
    name: South African National Biodiversity Institute
  - id: uct 
    number: 2 
    name: University of Cape Town

# This date determines the PUBLISHED date in the title block
date: last-modified

# Remember to rename the default .bib file and change the name here
bibliography: fw-references.bib

# This section sets up the page citation format. DO NOT EDIT
citation:
  type: webpage
  container-title: National Biodiversity Assessment 2025
  publisher: South African National Biodiversity Institute
  url: http://nba.sanbi.org.za/
# Do not edit or change any of the following entries
appendix-cite-as: false
google-scholar: true
---

*Rivers are among the least protected ecosystems in South Africa. A whole catchment approach is needed to bend the curve on river conservation, as rivers are highly connected linear ecosystems that may be impacted by human activities throughout their catchment. Rivers within protected areas that were assessed to be Poorly Protected due to their ecological condition may be prime targets for strategic restoration.*

![The stunning Mtentu River forms the border of Mkabati Nature Reserve in the Eastern Cape. (© Nancy Job)](imgs/mkambati_river.png)

------------------------------------------------------------------------

::::: columns
::: {.column width="50%"}
<center>

| [3%]{.inline-style-well-protected}
| of river ecosystem length
| [Well Protected]{.inline-style-indicator}

</center>
:::

::: {.column width="50%"}
<center>

| [8%]{.inline-style-well-protected}
| of 222 river ecosystem types
| [Well Protected]{.inline-style-indicator}

</center>
:::
:::::

:::: columns
::: {.column width="50%"}
:::
::::

------------------------------------------------------------------------

Approximately 14% of the country’s river length occurs in protected areas. Of the rivers within protected areas, approximately 60% of these were assessed to be in a natural or near-natural ecological condition. This is much higher than the roughly 37% of rivers in a natural or near-natural ecological condition country-wide. However, this means that only 8% of river ecosystem types in South Africa are considered Well Protected, 13% Moderately Protected and 48% Poorly Protected, while 31% are considered Not Protected.

::: panel-tabset
## Map

![Ecosystem protection level for river ecosystem types. The inset graph shows the number of ecosystem types per protection level category.](imgs/riv_epl_map.png){#fig-epl_riv_map}

## Data

```{r}
#| label: tbl-epl
#| tbl-cap: "Ecosystem protection level of river ecosystem types."

# library(here)
library(stringr)
library(reactable)
library(dplyr)

# load data
epl <- read.csv(file=list.files(pattern = "^river_metrics_2.csv$", recursive = TRUE, full.names = TRUE), # ^riv_metrics_type.csv$
                    stringsAsFactors = FALSE, check.names = FALSE) %>% 
  select(type, zone, protection_level) %>% 
  ## take out the NA zones
  filter(!is.na(zone)) %>% 
  rename("River type" = type,
         "Geomorphic zone" = zone,
         "Ecosystem protection level" = protection_level)
  # select(RIVTYPE, zone, protection_level) %>% # , RLE24, extent, RLE_EPL24) #
  # mutate(EPL24_all = str_replace_all(EPL24_all, "WP","Well Protected"),
  #        EPL24_all = str_replace_all(EPL24_all, "MP","Moderately Protected"),
  #        EPL24_all = str_replace_all(EPL24_all, "PP","Poorly Protected"),
  #        EPL24_all = str_replace_all(EPL24_all, "NP","Not Protected" )) %>% 
  # rename("River type" = RIVTYPE,
  #        "Geomorphic zone" = zone,
  #        "Ecosystem protection level" = EPL24_all)

# create the table
reactable(
  epl,
  filterable = TRUE,
  searchable = FALSE,
  pagination = FALSE,
  height = 480,
  defaultColDef = colDef(
    headerStyle = list(background = "#4097C2", color = "white", fontWeight = "bold")
  ),
  theme = reactableTheme(
    inputStyle = list(
      color = "black", # create black searching text in the filter box, otherwise one doesn't see it!
      backgroundColor = "white",
      border = "1px solid #ccc"
    )),
  style = list(fontSize = "12px"))

```
:::

The rivers of northern KwaZulu-Natal, Lowveld and Succulent Karoo are generally better protected than other regions of the country. In contrast, protection levels are particularly low in the northern interior of the country, reflecting the spatial distribution of the current protected areas network.

<!-- ::: {#box-epl .callout-note .freshwater collapse="true" title="Box 1. River ecosystem protection levels"} -->

<!-- # ```{r} -->

<!-- #| label: tbl-epl -->

<!-- #| tbl-cap: "Ecosystem protection level of river ecosystem types." -->

<!-- # library(here) -->

<!-- library(stringr) -->

<!-- library(reactable) -->

<!-- library(dplyr) -->

<!-- # load data -->

<!-- epl <- read.csv(file=list.files(pattern = "^river_metrics_2.csv$", recursive = TRUE, full.names = TRUE), # ^riv_metrics_type.csv$ -->

<!--                     stringsAsFactors = FALSE, check.names = FALSE) %>%  -->

<!--   select(type, zone, protection_level) %>%  -->

<!--   ## take out the NA zones -->

<!--   filter(!is.na(zone)) %>%  -->

<!--   rename("River type" = type, -->

<!--          "Geomorphic zone" = zone, -->

<!--          "Ecosystem protection level" = protection_level) -->

<!--   # select(RIVTYPE, zone, protection_level) %>% # , RLE24, extent, RLE_EPL24) # -->

<!--   # mutate(EPL24_all = str_replace_all(EPL24_all, "WP","Well Protected"), -->

<!--   #        EPL24_all = str_replace_all(EPL24_all, "MP","Moderately Protected"), -->

<!--   #        EPL24_all = str_replace_all(EPL24_all, "PP","Poorly Protected"), -->

<!--   #        EPL24_all = str_replace_all(EPL24_all, "NP","Not Protected" )) %>%  -->

<!--   # rename("River type" = RIVTYPE, -->

<!--   #        "Geomorphic zone" = zone, -->

<!--   #        "Ecosystem protection level" = EPL24_all) -->

<!-- # create the table -->

<!-- reactable( -->

<!--   epl, -->

<!--   filterable = TRUE, -->

<!--   searchable = FALSE, -->

<!--   pagination = FALSE, -->

<!--   height = 600, -->

<!--   defaultColDef = colDef( -->

<!--     headerStyle = list(background = "#4097C2", color = "white", fontWeight = "bold") -->

<!--   ), -->

<!--   theme = reactableTheme( -->

<!--     inputStyle = list( -->

<!--       color = "black", # create black searching text in the filter box, otherwise one doesn't see it! -->

<!--       backgroundColor = "white", -->

<!--       border = "1px solid #ccc" -->

<!--     )), -->

<!--   style = list(fontSize = "12px")) -->

<!-- ``` -->

<!-- ::: -->

In terms of river geomorphological zone, only 16% of the river ecosystem types within the lower foothill and mountain stream zones are Well Protected. More than half of lowland river ecosystem types are Not Protected (61%), reflecting the bias of the protected area network towards mountain versus lowland areas.

:::: panel-tabset
## Figure

<!-- it is important to use second-level headings in panel tabsets, i.e. two hashes -->

```{r}
#| label: fig-river_epl_bargraph
#| fig-cap: "River ecosystem protection level within each geomorphological zone (slope category). (a) The percentage of ecosystem types per category (labelled with the number per type); (b) the percentage of river length (km) within each category, providing an indication of the relative extent of each category." 
# with the total for all rivers at the bottom
#  with the total length for all rivers at the bottom –

library(tidyverse)
library(stringr)
library(nbaR)

# load data
riv_epl_tbl <- read.csv(file=list.files(pattern = "^river_metrics_2.csv$", recursive = TRUE, full.names = TRUE), # ^riv_metrics_type.csv$
                    stringsAsFactors = FALSE, check.names = FALSE) %>% 
  select(type, zone, protection_level, leng) %>% 
  ## take out the NA zones
  filter(!is.na(zone)) %>% 
  group_by(zone, protection_level) %>%
  summarise(count = n(),
            extent = sum(leng)) # %>%
  
  # select(RIVTYPE, zone, EPL24_all, tot_leng18) %>% # , RLE24, extent, RLE_EPL24) #
  # mutate(EPL24_all = str_replace_all(EPL24_all, "WP","Well Protected"),
  #        EPL24_all = str_replace_all(EPL24_all, "MP","Moderately Protected"),
  #        EPL24_all = str_replace_all(EPL24_all, "PP","Poorly Protected"),
  #        EPL24_all = str_replace_all(EPL24_all, "NP","Not Protected" )) %>% 
  # group_by(zone, EPL24_all) %>%
  # summarise(count = n(),
  #           extent = sum(tot_leng18)) # %>% 
  # rename("River type" = RIVTYPE,
  #        Zone = zone,
  #        "Ecosystem protection level" = EPL24_all) %>%
  
# count table
count <- riv_epl_tbl %>%
  pivot_wider(
    id_cols = zone, # zone
    names_from = protection_level, # EPL24_all
    values_from = count) %>%
  mutate(across(where(is.numeric), ~replace_na(.x,0))) %>% 
  ungroup() %>% 
  select(zone, 'Well Protected', 'Moderately Protected', 'Poorly Protected', 'Not Protected') # %>% # reorder the columns
  # rowwise() %>% 
  # mutate(Total = sum(as.numeric(c_across(contains("Protected"))), na.rm = TRUE)) %>% 
  # ungroup()
# count

# ## add a totals row:
# count <- count %>%
#   bind_rows(
#     count %>%
#       summarise(across(where(is.numeric), ~ sum(.x, na.rm = TRUE))) %>%
#       mutate(zone = "Total count") %>%
#       select(zone, everything())
#   )
# count

# extent table
extent <- riv_epl_tbl %>%
  ## WARNING: DIVIDING BY 1000 TO TRANSFORM TO KM, ASSUMING THESE ARE IN M
  mutate(extent = extent/1000) %>% 
  pivot_wider(
    id_cols = zone, # zone
    names_from = protection_level, # EPL24_all
    values_from = extent) %>%
  mutate(across(where(is.numeric), ~replace_na(.x,0))) %>% 
  ungroup() %>% 
  select(zone, 'Well Protected', 'Moderately Protected', 'Poorly Protected', 'Not Protected') # %>% # reorder the columns
  # rowwise() %>% 
  # mutate(Total = sum(as.numeric(c_across(contains("Protected"))), na.rm = TRUE)) %>% 
  # ungroup()
# extent

# # add a totals row:
# extent <- extent %>%
#   bind_rows(
#     extent %>%
#       summarise(across(where(is.numeric), ~ sum(.x, na.rm = TRUE))) %>%
#       mutate(zone = "Total extent") %>%
#       select(zone, everything())
#   )
# extent

# combine count and extent in a single table
epl_combined <- count %>%
  mutate(metric = "count") %>%
  bind_rows(extent %>%
              mutate(metric = "extent")) %>%
  mutate(zone = factor(zone, levels = c("Mountain stream", "Upper foothill", "Lower foothill", "Lowland river")))
# epl_combined
    
## save the data to downloadable csv for the link, before arranging by zone for the plot
write.csv(epl_combined, file = "outputs/rivers_EPL.csv", row.names = FALSE)

# create EPL plot
epl_combined_plot <- epl_combined %>% 
    arrange(desc(zone)) %>% # zone 
  nba_plot_comb(
    zone,
    METRIC_COL = metric,
    METRICS = c("count", "extent"),
    2:5,
    CHRT = "bar",
    NUM = FALSE,
    LAB = "Percentage of ecosystem",
    SAVE = NULL) 

epl_combined_plot


```

## Data

<!--# If the table is long use the div to give it a vertical scroll bar. Otherwise the div can be excluded. -->

::: {#table .table style="height:500px;overflow-y: auto"}
```{r}
#| label:  tbl-river_epl
#| tbl-cap: Protection level of river ecosystem types summarised by geomorphological zone. Note that extent figures represent river length (km) and have been rounded. 
#| classes: plain

library(dplyr)
library(nbaR)
library(gt)

## create the table
## create the table

tbl <- epl_combined %>% 
  mutate(metric = str_replace_all(metric, "extent", "Extent  (km)"),
         metric = str_replace_all(metric, "count", "Count")) %>% 
  arrange(zone) %>% 
  select(zone, metric, 'Well Protected', 'Moderately Protected', 'Poorly Protected', 'Not Protected') %>%
  mutate(across(where(is.numeric), round)) %>% 
  gt::gt(
    rowname_col = "metric",
    groupname_col = "zone",
    row_group_as_column = TRUE) %>% 
  fmt_number(
    columns = where(is.numeric),
    decimals = 0,
    sep_mark = "\u202F") %>% 
  fmt_markdown(columns = metric) %>%  # tells gt to render HTML/Markdown in that column
  nbaR::nba_tbl_theme(HEADER = "Freshwater") %>% 
  tab_style(
    style = cell_text(color = "white"),
    locations = cells_column_labels()
  )

tbl


```
:::

Download the data [here](outputs/rivers_EPL.csv).
::::

## Intersection of ecosystem threat status and protection levels

Combining the headline indicators provides an additional perspective on the status of river ecosystems. There are 67 river ecosystem types that are both highly threatened and under-protected. Although the Cape fold mountains support multiple protected area types including mountain catchment area and nature reserves, as well as several OECM measures in progress, reports of worsening river ecological condition across the Western Cape identify this area as important for increased protection. Similarly, the upper Wilge catchment, the western region of the Eastern Cape, and selected rivers of the Free State and Limpopo province are also candidates for focussed action.

![Highly threatened and under-protected river ecosystem types.](imgs/riv_unluckies_map.png){#fig-riv_ets_epl_map}

```{r}
#| label: tbl-unluckies
#| tbl-cap: "The intersection of ecosystem threat status and protection level reveals the ecosystem types that require priority action."
#| classes: plain

library(reactable)
library(tidyverse)
library(nbaR)

# load and prep data
unlucky_tbl <- read.csv(file=list.files(pattern = "^river_metrics_2.csv$", recursive = TRUE, full.names = TRUE), # ^riv_metrics_type.csv$
                        stringsAsFactors = FALSE, check.names = FALSE) %>%
  select(type, zone, threat_status, protection_level) # %>% # RIVTYPE, zone, EPL24, RLE24
  #     ## rename some variables for use below
  # rename(protection_level = EPL24,
  #        threat_status = RLE24) %>%
  # ## rename the abbreviated threat levels
  # mutate(threat_status = str_replace_all(threat_status, "CR","Critically Endangered" ),
  #        threat_status = str_replace_all(threat_status, "EN","Endangered" ),
  #        threat_status = str_replace_all(threat_status, "VU","Vulnerable" ),
  #        threat_status = str_replace_all(threat_status, "NT","Near Threatened" ), 
  #        threat_status = str_replace_all(threat_status, "LC","Least Concern" )) %>% 
  # ## rename the abbreviated protection levels
  # mutate(protection_level = str_replace_all(protection_level, "WP","Well Protected"),
  #        protection_level = str_replace_all(protection_level, "MP","Moderately Protected"), 
  #        protection_level = str_replace_all(protection_level, "PP","Poorly Protected"),
  #        protection_level = str_replace_all(protection_level, "NP","Not Protected")) 

# plot:
nbaR::nba_tbl_comb(DF = unlucky_tbl,
                   GROUP = type,
                     THR = threat_status,
                     PRO = protection_level,
                     FILE ="csv")

```

```{=html}
<!--# ::: {#box-1 .callout-note .freshwater title="Box 1. River ecosystem protection level across primary catchments" collapse="true"}
## **Box 1. Primary Catchments and River ecosystem protection level**

Text

***Heading 3***

### *Protection Level of South Africa's major rivers*

Text .
:::

::: {#box-2 .callout-note .freshwater title="Box 2. River ecosystem protection level across provinces" collapse="true"}
## **Box 2. River ecosystem protection level across the Provinces**

Text

***Heading 3*** xxxx.
:::

::: {#box-3 .callout-note .freshwater title="Box 3. River ecosystem protection level across national parks" collapse="true"}
## **Box 3. River ecosystem protection level across National Parks**

Text

***Heading 3*** xxxx.
::: -->
```

## Approach

Ecosystem protection level is a headline indicator of the National Biodiversity Assessment. It measures the degree to which ecosystem types are represented within South Africa’s protected area network[@governmentofsouthafrica.2003]. Read more about this indicator on the [ecosystem protection level](../integrated-findings/chl_epl_explained.qmd) explainer page.

Key input layers include the South African protected areas database, the [river ecosystem network](fw_riv_type.qmd), and [river ecological condition](fw_riv_condition.qmd) assessment[@southafricanprotectedareasdatabase2024].

While the 2018 assessment used a standard 20% target for freshwater ecosystems[@roux2008], the current protection level target was adjusted to 30% in line with Target 3 of the Global Biodiversity Framework. This target is applied to each of the 222 river ecosystem types. Importantly, the current ecological condition of the river within the protected area is taken into consideration in the calculation, ensuring that effectiveness is accounted for. At least 30% of each river ecosystem type (i.e. the ecosystem target) needs to be in a natural or near natural ecological condition (ecological class A or B) to qualify in the Well Protected category. If this target was not met, the ecosystem type is categorised as Moderately Protected or lower, meaning that higher integrity rivers contribute more to meeting protection level targets than low integrity rivers.

Ecosystem types were assigned to one of four categories based on the percentage of the protection target met within the protected areas network, and scaled by ecological condition: **Well Protected**: 100% (or more) of a river ecosystem type’s target falls within the protected area network; but only rivers in an A and B condition are considered to contribute; **Moderately Protected**: 50% to 99% of a river ecosystem type’s target falls within the protected area network; and rivers in an A and B condition contribute 100%, rivers in a C and D condition contribute 30%, while E and F condition rivers contribute only 10%; **Poorly Protected**: 5% to 49% of a river ecosystem type’s target falls within the protected area network; and A and B condition rivers contribute 100%, C and D condition rivers contribute 30%, E and F condition rivers contribute 10%; **Not Protected**: less than 5% of a river ecosystem type’s target falls within the protected area network; and A and B condition rivers contribute 100%, C and D condition rivers contribute 30%, E and F condition rivers contribute 10%.

![Ecosystem protection level categories and the use of ecosystem condition data to moderate contribution to targets.](imgs/EPL_table.png){#tbl-eplcon width="600"}

Changes in ecosystem protection level results since the 2018 assessment reflect revised targets and improved methodologies for global and national alignment, alongside genuine changes in protection and updates to river ecological condition.

## Technical documentation

**Code repository**

Skowno, A.L. 2025. SANBI-NBA River ecosystem protection level \[Source code\]. GitHub repository available at <https://github.com/askowno/EPL_riv>

**Key publications**

Harris, L.R., Skowno, A.L., Holness, S.D., Sink, K.J., van Niekerk, L., van Deventer, H., Smith-Adao, L., Job, N., Khatieb, S., Monyeki, M. (in review). Indicators for tracking progress in effective, representative ecosystem protection.

## Recommended citation

```{r}
#| output: asis
#| label: lst-citation-code

library(nbaR) 
library(knitr)
library(rmarkdown)

# Code for fetching the yaml metadata
# Note that this only runs when the .qmd file is rendered, therefore the outputs of this code block will return no results if you try to run it within R - that does not mean it is not working

meta <- knitr::opts_knit$get("rmarkdown.pandoc.to")  # forces knitr to load metadata
meta <- rmarkdown::metadata  # full YAML is now in `meta`

nba_citation(meta)
```

## References

::: {#refs}
:::
